var e="slot",t="text",r="html",n="value",a="class",o="attribute",i="data",l="event",s=Symbol("mount"),f=Symbol("unmount"),u=Symbol("move"),d=Symbol("root"),v=Symbol("target"),c="SLOT",g=new WeakMap,p=new WeakMap,m=new WeakMap,h=new WeakMap,y=new WeakMap,b=new WeakMap,N=new WeakMap,S=new WeakMap,x=new WeakMap,w=new WeakMap,E={set:W,deleteProperty:W},k={set:B,deleteProperty:B},A=[],M={},L={};function B(e,t,r,n,a){if(K.isDeferred&&!a)return T((function(){return B(e,t,r,n,!0)})),!0;K.debug&&console.log("setIndex",arguments);var o=Number.parseInt("string"==typeof t?t:null,10),i=!Number.isNaN(o),l=void 0!==r;if("length"===t)for(var s=e.length-1,f=r;f<=s;f+=1){var u=e[f],v=b.get(u),c=h.get(u);v&&D(v[0],v[1],c,u),delete e[f]}if(!l&&e[t]){var g=e[t],p=b.get(g),m=h.get(g);D(p[0],p[1],m,g),delete e[t]}if(l){if(!i)return Reflect.set(e,t,r,n);if(!e.includes(r)){var x=S.get(n),w=x.parentNode,E=N.get(n),k=z(r,E,n[d]),A=k[0],M=k[1],L=e[t],W=null,P=e.length-1;for(f=o+1;f<=P&&!(W=e[f]);f+=1);if(L&&!e.find((function(e,t){return e===L&&t!==o}))){var O=b.get(L),C=h.get(L);D(O[0],O[1],C,A)}if(W){var R=b.get(W)[0];w.insertBefore(M,R)}else{var j=b.get(n)[1];w.insertBefore(M,j)}return Reflect.set(e,t,A,n)}var H=e.findIndex((function(e,t){return e===r&&t!==o})),q=e[t],F=y.get(r),I=b.get(r),_=I[0],G=I[1];if(q){var J=b.get(q),Q=J[0],U=J[1],V=y.get(q),X=I[1].nextSibling,Y=X.parentNode;if(r!==q){if(F)for(var Z=_.nextSibling;!Z.isSameNode(G);){var $=Z;Z=Z.nextSibling,F.call(r,$)}if(V)for(var ee=Q.nextSibling;!ee.isSameNode(U);){var te=ee;ee=ee.nextSibling,V.call(q,te)}for(var re=_;!re.isSameNode(G);){var ne=re;re=re.nextSibling,Y.insertBefore(ne,Q)}Y.insertBefore(G,Q);for(var ae=Q;!ae.isSameNode(U);){var oe=ae;ae=ae.nextSibling,Y.insertBefore(oe,X)}Y.insertBefore(U,X)}}else if(F)for(var ie=_.nextSibling;!ie.isSameNode(G);){var le=ie;ie=ie.nextSibling,F.call(r,le)}~H&&Reflect.set(e,H,q,n),Reflect.set(e,t,r,n)}return!0}function T(e){return A.length||requestAnimationFrame((function(){for(var e=A.length;A.length;){A.shift()()}return K.debug?console.log("queue flushed",e):null})),A.push(e)}function W(t,r,a,o,i){if(K.isDeferred&&!i)return T((function(){return W(t,r,a,o,!0)})),!0;K.debug&&console.log("setProperty",arguments);var s=g.get(t),f=void 0!==a,u=t[r]!==a,d=s[r],v=null,c=null;if(d)for(var p=d.length,m=0;m<p;m+=1){var h=d[m];if(v=h.node,c=h.type,u||i)if(c in L&&"function"!=typeof a)L[c](v,h.name,a);else if(c===l&&H(t,a,h,o),c===e){var y=j(t,r,a,o,h,i);if(y)return Reflect.set(t,r,y,o)}c!==n||h.isListening||(v.addEventListener("input",(function(e){return Reflect.set(t,r,e.target.value,o)})),h.isListening=!0)}return f?Reflect.set(t,r,a,o):delete t[r],!0}function P(e,t,r){return null!=r?t in e?e[t]=r:e.setAttribute(t,r):e.removeAttribute(t)}function O(e,t,r){return null!=r?e.dataset[t]=r:delete e.dataset[t]}function C(e,t,r){return r?e.className=Array.isArray(r)?r.split(" "):r:e.removeAttribute("class")}function D(e,t,r,n){var a=e,o=a;for(a=a.nextSibling,o.remove();!a.isSameNode(t);)!function(){var e=a;a=a.nextSibling,r?Promise.resolve(r.call(n,e)).then((function(){return e.remove()})):e.remove()}();return t.remove(),R(n)}function R(e,t){for(var r in e){var n=e[r];"object"==typeof n&&null!==n&&R(n,!0)}if(t){var a=h.get(e);return a?a.call(e):null}}function j(e,t,r,n,a,o){if(K.debug&&console.log("setSlot",arguments),(e[t]||r||o)&&(void 0===r||"object"==typeof r)){var i=a.node,l=a.slot,s=a.template,f=m.get(e),u=f[t],v=i.parentNode,c=G(0,t),g=G(1,t),p=e[t],y=Array.isArray(p),N=p&&"object"==typeof p,x=Array.isArray(r),w=y!==x,E=null;if(u&&(!r||r&&!p||w)){if(Array.isArray(p))for(var k=p.length,A=0;A<k;A+=1){var M=p[A],L=h.get(M),B=b.get(M);B&&D(B[0],B[1],L,M)}else if(p){var T=h.get(p),W=b.get(p);D(W[0],W[1],T,p)}r&&!p?D(u[0],u[1]):(u[0].remove(),u[1].remove())}if(f[t]=[c,g],v.insertBefore(c,i),r)if(p&&N&&!w){for(var P=y?p:[p],O=x?r:[r],C=O.length-1,R=0;R<=C;R+=1){var j=P[R],H=O[R];if(j){for(var t in H)j[t]=H[t];for(var t in j)H.hasOwnProperty(t)||delete j[t]}else P[R]=H}Array.isArray(p)&&(P.length=O.length),E=p}else if(Array.isArray(r)){for(var q=_(r,s,n[d]),F=q[0],I=q[1],J=F.length,Q=0;Q<J;Q+=1){var U=F[Q];v.insertBefore(U,i)}S.set(I,i),b.set(I,f[t]),E=I}else{var V=z(r,s,n[d]),X=V[0],Y=V[1];v.insertBefore(Y,i),E=X}else for(var Z=l.childNodes,$=Z.length,ee=0;ee<$;ee+=1){var te=Z[ee];v.insertBefore(te.cloneNode(!0),i)}return v.insertBefore(g,i),E}}function H(e,t,r,n){var a=r.node,o=r.event,i=p.get(e),l=i[o];if(l&&a.removeEventListener(o,l,l.options),t){t.isEventListener=!0;var s=t.bind(n);return s.options=t.options,a.addEventListener(o,s,s.options),i[o]=s}}function q(s){var f=(s.content||s).cloneNode(!0),u={};return function s(f,d){for(var v=f.childNodes.length-1,g=0;g<=v;g+=1){var p=f.childNodes[g];if(p.nodeType===Node.ELEMENT_NODE)if(p.tagName===c||p.dataset.key){var m=p.dataset.key||p.name,h=G(2,m),y=p.dataset.template,b=y?M[y]||document.querySelector(y):p;if(void 0===m)throw new TypeError("Missing `name` or `data-key` for slot.");if(delete p.dataset.key,!y&&p.tagName===c)for(b=document.createDocumentFragment();p.childNodes.length;){var N=p.childNodes[0];b.appendChild(N)}f.insertBefore(h,p),u.hasOwnProperty(m)||(u[m]=[]),u[m].push({path:d.concat(g),slot:y?p:document.createElement("div"),template:b,type:e}),p.remove()}else for(var S in p.children.length&&s(p,d.concat(g)),p.dataset){var x=p.dataset[S],w=null;switch(S){case"text":w={type:t};break;case"value":w={type:n};break;case"class":w={type:a};break;case"unsafeHtml":w={type:r}}S.startsWith("attribute")&&(w={type:o,name:S.slice(9).toLowerCase()}),S.startsWith("event")&&(w={type:l,event:S.slice(5).toLowerCase()}),w||(w={type:i,name:S},x||(x=S)),w&&(delete p.dataset[S],p.removeAttribute(S),w.path=d.concat(g),u.hasOwnProperty(x)||(u[x]=[]),u[x].push(w))}}}(f,[]),x.set(s,f),w.set(s,u)}function F(e,t){var r=w.get(t),n={};for(var a in r){n[a]=[];for(var o=r[a],i=o.length,l=0;l<i;l+=1){var s=o[l],f=I(e,s.path);n[a].push(Object.assign({node:f},s))}}return n}function I(e,t){for(var r=e,n=t.length-1,a=0;a<=n;a+=1){var o=t[a];r=r.childNodes[o]}return r}function _(e,t,r){for(var n=[],a=[],o=null,i=e.length,l=0;l<i;l+=1){var s=z(e[l],t,r);a.push(s[0]),n.push(s[1])}return(o=new Proxy(a,k))[d]=r,N.set(o,t),[n,o]}function z(e,t,r){x.get(t)||q(t);var n=x.get(t).cloneNode(!0),a={},o=new Proxy(a,E),i=F(n,t),l=G(0,"proxy"),c=G(1,"proxy"),N=[l,c],S=e[s],w=e[f],k=e[u],A=document.createDocumentFragment();for(var M in w&&h.set(o,w),k&&y.set(o,k),g.set(a,i),p.set(a,{}),m.set(a,{}),o[d]=r||o,o[v]=e,e)i.hasOwnProperty(M)||(a[M]=e[M]);for(var M in i)W(a,M,e[M],o,!0);if(S)if(n.nodeType===Node.ELEMENT_NODE)S.call(o,n);else for(var L=n.childNodes,B=L.length,T=0;T<B;T+=1){var P=L[T];P.nodeType===Node.ELEMENT_NODE&&S.call(o,P)}return A.appendChild(l),A.appendChild(n),A.appendChild(c),b.set(o,N),[o,A]}function G(e,t){if(K.debug){var r=(0===e?"start":1===e?"end":"anchor")+" "+t;return document.createComment(r)}return document.createTextNode("")}function J(e,t){if("string"==typeof t){var r=document.createElement("template");r.innerHTML=t,t=r}return M[e]=t}function K(e,t){return M.hasOwnProperty(t)&&(t=M[t]),z(e,t)}L[t]=function(e,t,r){return r!==e.textContent?e.textContent=r:null},L[r]=function(e,t,r){return r!==e.innerHTML?e.innerHTML=r||"":null},L[n]=function(e,t,r){if(r!==e.value)return e.value=void 0===r?"":r},L[a]=C,L[o]=P,L[i]=O,K.debug=!1,K.isDeferred=!1;export{s as mount,f as unmount,u as move,d as root,v as target,J as registerTemplate};export default K;
