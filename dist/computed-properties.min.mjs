var r=new WeakMap,e=new WeakMap,t=[],n=!1,o=Symbol("stackDelimiter"),a=Symbol("ref"),i=Symbol("hasUnmounted");globalThis.observableContextMap=r,globalThis.targetObservablesMap=e;var f=function(){var r=p();return{get:s,set:r,deleteProperty:r}}(),u=function(){var r=p(!0);return{get:s,set:r,deleteProperty:r}}();function l(){for(;t.length;)t.pop();return n=!1}function c(){for(var r=t.length-1;r>=0&&"symbol"!=typeof t.pop();r-=1);}function s(r,e,o){for(var a=!1,i=t.length-1;i>=0;i-=1){var f=t[i];if("symbol"==typeof f)break;f[0]===r&&f[1]===e&&(a=!0)}return a||(t.push([r,e]),n||(n=!0,queueMicrotask(l))),Reflect.get(r,e,o)}function v(r){return r&&"object"==typeof r}function p(e){return function(t,n,o,f){var u=t[n];if(u===o)return!0;if(e&&v(o)&&!o[a]){if(v(u)&&!u[a])return h(f[n],o),!0;o=y(o,!0)}void 0!==o?Reflect.set(t,n,o,f):Reflect.deleteProperty(t,n);var l,c=r.get(t);if(!c)return!0;for(var s=(l=c[n]||[]).length,p=0;p<s;p+=1){var b=l[p];if(b){var d=b[0],m=b[1],P=b[2];d[i]||g(d,m,P)}}return!0}}function h(r,e){for(var t in e){var n=e[t],o=r[t];v(n)&&v(o)?h(o,n):r[t]=n}for(var t in r){r[t];e.hasOwnProperty(t)||delete r[t]}}function y(r,e){r||(r={});var t=new Proxy(r,e?u:f),n=r[Object.getOwnPropertySymbols(r)[0]];if(e)for(var o in r){var i=r[o];v(i)&&!i[a]&&(r[o]=y(i,!0))}return"function"==typeof n&&n.call(t),t}function g(n,a,i){t.push(o);var f=i.call(n),u=[];void 0!==f?n[a]=f:delete n[a],e.set(n,u);for(var l=t.length-1;l>=0&&t[l]!==o;l-=1){var s=t[l],v=s[0],p=s[1],h=null;u.includes(v)||u.push(v),r.has(v)||r.set(v,{}),(h=r.get(v)).hasOwnProperty(p)||(h[p]=[]);var y=h[p],g=y.findIndex((function(r){return r[0]===n&&r[1]===a}));-1!==g&&y.splice(g,1),y.unshift([n,a,i])}return c(),f}function b(t){var n=e.get(t);if(n){for(var o=n.length,a=0;a<o;a+=1){var f=n[a],u=r.get(f);for(var l in u)for(var c=u[l],s=c.length-1;s>=0;s-=1){c[s][0]===t&&c.splice(s,1)}}return t[i]=!0}}function d(r,e){return function(t){var n=t[r],o=t[e];return t[r]=function(){if(n&&n.call(this),!arguments.length)for(var r in t){var e=t[r];"function"==typeof e&&e.call(this)}},t[e]=function(){return o&&o.call(this),b(this)},Object.keys(t).forEach((function(r){var e=t[r];if("function"==typeof e){return t[r]=function(){var t=this[r];return t&&t.isEventListener?e.apply(this,arguments):g(this,r,e)}}})),t}}function m(r){return r[a]=!0,r}export{y as observable,y as createSource,d as createComputed,m as ref};
