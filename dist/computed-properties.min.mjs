var r=new WeakMap,t=new WeakMap,e=[],n=!1,o=Symbol("stackDelimiter"),a=Symbol("ref"),i=Symbol("hasUnmounted"),f=Symbol("proxyTarget"),u=function(){var r=h();return{get:s,set:r,deleteProperty:r}}(),c=function(){var r=h(!0);return{get:s,set:r,deleteProperty:r}}();function l(){for(;e.length;)e.pop();return n=!1}function v(){for(var r=e.length-1;r>=0&&e.pop()!==o;r-=1);}function s(r,t,a){if(t===f)return r;for(var i=!1,u=e.length-1;u>=0;u-=1){var c=e[u];if(c===o)break;c[0]===r&&c[1]===t&&(i=!0)}return i||(e.push([r,t]),n||(n=!0,queueMicrotask(l))),Reflect.get(r,t,a)}function p(r){var t=r&&r.constructor;return t===Object||t===Array}function h(t){return function(e,n,o,f){var u=e[n];if(u===o)return!0;if(t&&p(o)&&!o[a]){if(p(u)&&!u[a])return y(u,o),!0;o=g(o,!0)}void 0!==o?Reflect.set(e,n,o,f):Reflect.deleteProperty(e,n);var c,l=r.get(e);if(!l)return!0;for(var v=(c=l[n]||[]).length-1;v>=0;v-=1){var s=c[v];if(s){var h=s[0],d=s[1],O=s[2];h[i]||b(h,d,O)}}return!0}}function y(r,t){var e=r[f];for(var n in t){var o=t[n],i=e[n];p(o)&&p(i)&&!i[a]?y(i,o):r[n]=o}for(var n in e){e[n];Object.prototype.hasOwnProperty.call(t,n)||delete r[n]}}function g(r,t){r||(r={});var e=new Proxy(r,t?c:u),n=r[Object.getOwnPropertySymbols(r)[0]];if(t)for(var o in r){var i=r[o];p(i)&&!i[a]&&(r[o]=g(i,!0))}return"function"==typeof n&&n.call(e),e}function b(n,a,i){e.push(o);var f=e.length-1,u=null,c=i.call(n),l=[];void 0!==c?n[a]=c:delete n[a],t.set(n,l);for(var s=e.length-1,p=f+1;p<=s&&e[p]!==o;p+=1)u=p;var h=f+1;for(p=u;p>=h;p-=1){var y=e[p],g=y[0],b=y[1],d=null;l.includes(g)||l.push(g),r.has(g)||r.set(g,{}),d=r.get(g),Object.prototype.hasOwnProperty.call(d,b)||(d[b]=[]);var O=d[b],m=O.findIndex((function(r){return r[0]===n&&r[1]===a}));-1!==m&&O.splice(m,1),O.push([n,a,i])}return v(),c}function d(e){var n=t.get(e);if(n){for(var o=n.length,a=0;a<o;a+=1){var f=n[a],u=r.get(f);for(var c in u)for(var l=u[c],v=l.length-1;v>=0;v-=1){l[v][0]===e&&l.splice(v,1)}}return e[i]=!0}}function O(r,t){return function(e){var n=e[r],o=e[t];return e[r]=function(){if(n&&n.call(this),!arguments.length)for(var r in e){var t=e[r];"function"==typeof t&&t.call(this)}},e[t]=function(){return o&&o.call(this),d(this)},Object.keys(e).forEach((function(r){var t=e[r];if("function"==typeof t){return e[r]=function(){var e=this[r];return e&&e.isEventListener?t.apply(this,arguments):b(this,r,t)}}})),e}}function m(r){return r[a]=!0,r}export{g as observable,g as createSource,O as createComputed,m as ref};
