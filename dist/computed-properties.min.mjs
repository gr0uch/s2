var r=new WeakMap,t=new WeakMap,e=[],n=!1,o=Symbol("stackDelimiter"),f=Symbol("ref"),i=Symbol("hasUnmounted"),a=Symbol("proxyTarget"),u=function(){var r=h();return{get:s,set:r,deleteProperty:r}}(),l=function(){var r=h(!0);return{get:s,set:r,deleteProperty:r}}();function c(){for(;e.length;)e.pop();return n=!1}function v(){for(var r=e.length-1;r>=0&&e.pop()!==o;r-=1);}function s(r,t,f){if(t===a)return r;for(var i=!1,u=e.length-1;u>=0;u-=1){var l=e[u];if(l===o)break;l[0]===r&&l[1]===t&&(i=!0)}return i||(e.push([r,t]),n||(n=!0,queueMicrotask(c))),Reflect.get(r,t,f)}function p(r){return r&&"object"==typeof r}function h(t){return function(e,n,o,u){var l=e[n];if(l===o)return!0;if(t&&p(o)&&!o[f]){if(p(l)&&!l[f])return y(u[a][n],o),!0;o=g(o,!0)}void 0!==o?Reflect.set(e,n,o,u):Reflect.deleteProperty(e,n);var c,v=r.get(e);if(!v)return!0;for(var s=(c=v[n]||[]).length-1;s>=0;s-=1){var h=c[s];if(h){var d=h[0],m=h[1],P=h[2];d[i]||b(d,m,P)}}return!0}}function y(r,t){var e=r[a];for(var n in t){var o=t[n],f=e[n];p(o)&&p(f)?y(f,o):r[n]=o}for(var n in e){e[n];t.hasOwnProperty(n)||delete r[n]}}function g(r,t){r||(r={});var e=new Proxy(r,t?l:u),n=r[Object.getOwnPropertySymbols(r)[0]];if(t)for(var o in r){var i=r[o];p(i)&&!i[f]&&(r[o]=g(i,!0))}return"function"==typeof n&&n.call(e),e}function b(n,f,i){e.push(o);var a=e.length-1,u=null,l=i.call(n),c=[];void 0!==l?n[f]=l:delete n[f],t.set(n,c);for(var s=e.length-1,p=a+1;p<=s&&e[p]!==o;p+=1)u=p;var h=a+1;for(p=u;p>=h;p-=1){var y=e[p],g=y[0],b=y[1],d=null;c.includes(g)||c.push(g),r.has(g)||r.set(g,{}),(d=r.get(g)).hasOwnProperty(b)||(d[b]=[]);var m=d[b],P=m.findIndex((function(r){return r[0]===n&&r[1]===f}));-1!==P&&m.splice(P,1),m.push([n,f,i])}return v(),l}function d(e){var n=t.get(e);if(n){for(var o=n.length,f=0;f<o;f+=1){var a=n[f],u=r.get(a);for(var l in u)for(var c=u[l],v=c.length-1;v>=0;v-=1){c[v][0]===e&&c.splice(v,1)}}return e[i]=!0}}function m(r,t){return function(e){var n=e[r],o=e[t];return e[r]=function(){if(n&&n.call(this),!arguments.length)for(var r in e){var t=e[r];"function"==typeof t&&t.call(this)}},e[t]=function(){return o&&o.call(this),d(this)},Object.keys(e).forEach((function(r){var t=e[r];if("function"==typeof t){return e[r]=function(){var e=this[r];return e&&e.isEventListener?t.apply(this,arguments):b(this,r,t)}}})),e}}function P(r){return r[f]=!0,r}export{g as observable,g as createSource,m as createComputed,P as ref};
