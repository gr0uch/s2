var r=new WeakMap,e=new WeakMap,t=[],n=!1,o=Symbol("stackDelimiter"),a=Symbol("ref"),i=Symbol("hasUnmounted");globalThis.observableContextMap=r,globalThis.targetObservablesMap=e;var f=function(){var r=h();return{get:v,set:r,deleteProperty:r}}(),u=function(){var r=h(!0);return{get:v,set:r,deleteProperty:r}}();function l(){for(;t.length;)t.pop();return n=!1}function c(){for(var r=t.length-1;r>=0&&t.pop()!==o;r-=1);}function v(r,e,a){for(var i=!1,f=t.length-1;f>=0;f-=1){var u=t[f];if(u===o)break;u[0]===r&&u[1]===e&&(i=!0)}return i||(t.push([r,e]),n||(n=!0,queueMicrotask(l))),Reflect.get(r,e,a)}function s(r){return r&&"object"==typeof r}function h(e){return function(t,n,o,f){var u=t[n];if(u===o)return!0;if(e&&s(o)&&!o[a]){if(s(u)&&!u[a])return p(f[n],o),!0;o=g(o,!0)}void 0!==o?Reflect.set(t,n,o,f):Reflect.deleteProperty(t,n);var l,c=r.get(t);if(!c)return!0;for(var v=(l=c[n]||[]).length,h=0;h<v;h+=1){var b=l[h];if(b){var d=b[0],P=b[1],k=b[2];d[i]||y(d,P,k)}}return!0}}function p(r,e){for(var t in e){var n=e[t],o=r[t];s(n)&&s(o)?p(o,n):r[t]=n}for(var t in r){r[t];e.hasOwnProperty(t)||delete r[t]}}function g(r,e){r||(r={});var t=new Proxy(r,e?u:f),n=r[Object.getOwnPropertySymbols(r)[0]];if(e)for(var o in r){var i=r[o];s(i)&&!i[a]&&(r[o]=g(i,!0))}return"function"==typeof n&&n.call(t),t}function y(n,a,i){t.push(o);var f=i.call(n),u=[];void 0!==f?n[a]=f:delete n[a],e.set(n,u);for(var l=t.length-1;l>=0&&t[l]!==o;l-=1){var v=t[l],s=v[0],h=v[1],p=null;u.includes(s)||u.push(s),r.has(s)||r.set(s,{}),(p=r.get(s)).hasOwnProperty(h)||(p[h]=[]);var g=p[h],y=g.findIndex((function(r){return r[0]===n&&r[1]===a}));-1!==y&&g.splice(y,1),g.unshift([n,a,i])}return c(),f}function b(t){var n=e.get(t);if(n){for(var o=n.length,a=0;a<o;a+=1){var f=n[a],u=r.get(f);for(var l in u)for(var c=u[l],v=c.length-1;v>=0;v-=1){c[v][0]===t&&c.splice(v,1)}}return t[i]=!0}}function d(r,e){return function(t){var n=t[r],o=t[e];return t[r]=function(){if(n&&n.call(this),!arguments.length)for(var r in t){var e=t[r];"function"==typeof e&&e.call(this)}},t[e]=function(){return o&&o.call(this),b(this)},Object.keys(t).forEach((function(r){var e=t[r];if("function"==typeof e){return t[r]=function(){var t=this[r];return t&&t.isEventListener?e.apply(this,arguments):y(this,r,e)}}})),t}}function P(r){return r[a]=!0,r}export{g as observable,g as createSource,d as createComputed,P as ref};
