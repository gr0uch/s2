var e="slot",t="text",r="html",n="value",a="class",o="attribute",i="data",s="event",l=Symbol("mount"),f=Symbol("unmount"),u=Symbol("move"),v="SLOT",c=new WeakMap,d=new WeakMap,g=new WeakMap,p=new WeakMap,m=new WeakMap,h=new WeakMap,y=new WeakMap,b=new WeakMap,N=new WeakMap,x=new WeakMap,S={set:W,deleteProperty:W},w={set:L,deleteProperty:L},k=[],A={},M={};function L(e,t,r,n,a){if(G.isDeferred&&!a)return B((function(){return L(e,t,r,n,!0)})),!0;G.debug&&console.log("setIndex",arguments);var o=Number.parseInt(t,10),i=!Number.isNaN(o),s=void 0!==r;if("length"===t)for(var l=e.length-1,f=r;f<=l;f+=1){var u=e[f],v=h.get(u),c=p.get(u);v&&O(v[0],v[1],c,u),delete e[f]}if(!s&&e[t]){var d=e[t],g=h.get(d),N=p.get(d);O(g[0],g[1],N,d),delete e[t]}if(s){if(!i)return Reflect.set(e,t,r,n);if(!e.includes(r)){var x=b.get(n),S=x.parentNode,w=y.get(n),k=I(r,w),A=k[0],M=k[1],W=e[t],E=null,P=e.length-1;for(f=o+1;f<=P&&!(E=e[f]);f+=1);if(W&&!e.find((function(e,t){return e===W&&t!==o}))){var C=h.get(W),T=p.get(W);O(C[0],C[1],T,A)}if(E){var R=h.get(E)[0];S.insertBefore(M,R)}else{var D=h.get(n)[1];S.insertBefore(M,D)}return Reflect.set(e,t,A,n)}var j=e.findIndex((function(e,t){return e===r&&t!==o})),H=e[t],q=m.get(r),F=h.get(r),_=F[0],z=F[1];if(H){var J=h.get(H),K=J[0],Q=J[1],U=m.get(H),V=F[1].nextSibling,X=V.parentNode;if(r!==H){if(q)for(var Y=_.nextSibling;!Y.isSameNode(z);){var Z=Y;Y=Y.nextSibling,q.call(r,Z)}if(U)for(var $=K.nextSibling;!$.isSameNode(Q);){var ee=$;$=$.nextSibling,U.call(H,ee)}for(var te=_;!te.isSameNode(z);){var re=te;te=te.nextSibling,X.insertBefore(re,K)}X.insertBefore(z,K);for(var ne=K;!ne.isSameNode(Q);){var ae=ne;ne=ne.nextSibling,X.insertBefore(ae,V)}X.insertBefore(Q,V)}}else if(q)for(var oe=_.nextSibling;!oe.isSameNode(z);){var ie=oe;oe=oe.nextSibling,q.call(r,ie)}~j&&Reflect.set(e,j,H,n),Reflect.set(e,t,r,n)}return!0}function B(e){return k.length||requestAnimationFrame((function(){for(var e=k.length;k.length;){k.shift()()}return G.debug?console.log("queue flushed",e):null})),k.push(e)}function W(t,r,a,o,i){if(G.isDeferred&&!i)return B((function(){return W(t,r,a,o,!0)})),!0;G.debug&&console.log("setProperty",arguments);var l=c.get(t),f=void 0!==a,u=t[r]!==a,v=l[r],d=null,g=null;if(v)for(var p=v.length,m=0;m<p;m+=1){var h=v[m];if(d=h.node,g=h.type,u||i)if(g in M&&"function"!=typeof a)M[g](d,h.name,a);else if(g===s&&D(t,a,h,o),g===e){var y=R(t,r,a,h,i);if(y)return Reflect.set(t,r,y,o)}g!==n||h.isListening||(d.addEventListener("input",(function(e){return Reflect.set(t,r,e.target.value,o)})),h.isListening=!0)}return f?Reflect.set(t,r,a,o):delete t[r],!0}function E(e,t,r){return null!=r?t in e?e[t]=r:e.setAttribute(t,r):e.removeAttribute(t)}function P(e,t,r){return null!=r?e.dataset[t]=r:delete e.dataset[t]}function C(e,t,r){return r?e.className=Array.isArray(r)?r.split(" "):r:e.removeAttribute("class")}function O(e,t,r,n){var a=e,o=a;for(a=a.nextSibling,o.remove();!a.isSameNode(t);)!function(){var e=a;a=a.nextSibling,r?Promise.resolve(r.call(n,e)).then((function(){return e.remove()})):e.remove()}();return t.remove(),T(n)}function T(e,t){for(var r in e){var n=e[r];"object"==typeof n&&null!==n&&T(n,!0)}if(t){var a=p.get(e);return a?a.call(e):null}}function R(e,t,r,n,a){if(G.debug&&console.log("setSlot",arguments),(e[t]||r||a)&&(void 0===r||"object"==typeof r)){var o=n.node,i=n.slot,s=n.template,l=g.get(e),f=l[t],u=o.parentNode,v=_(0,t),c=_(1,t),d=e[t],m=Array.isArray(d),y=d&&"object"==typeof d,N=Array.isArray(r),x=m!==N,S=null;if(f&&(!r||r&&!d||x)){if(Array.isArray(d))for(var w=d.length,k=0;k<w;k+=1){var A=d[k],M=p.get(A),L=h.get(A);L&&O(L[0],L[1],M,A)}else if(d){var B=p.get(d),W=h.get(d);O(W[0],W[1],B,d)}r&&!d?O(f[0],f[1]):(f[0].remove(),f[1].remove())}if(l[t]=[v,c],u.insertBefore(v,o),r)if(d&&y&&!x){for(var E=m?d:[d],P=N?r:[r],C=P.length-1,T=0;T<=C;T+=1){var R=E[T],D=P[T];if(R){for(var t in D)R[t]=D[t];for(var t in R)D.hasOwnProperty(t)||delete R[t]}else E[T]=D}Array.isArray(d)&&(E.length=P.length),S=d}else if(Array.isArray(r)){for(var j=F(r,s),H=j[0],q=j[1],z=H.length,J=0;J<z;J+=1){var K=H[J];u.insertBefore(K,o)}b.set(q,o),h.set(q,l[t]),S=q}else{var Q=I(r,s),U=Q[0],V=Q[1];u.insertBefore(V,o),S=U}else for(var X=i.childNodes,Y=X.length,Z=0;Z<Y;Z+=1){var $=X[Z];u.insertBefore($.cloneNode(!0),o)}return u.insertBefore(c,o),S}}function D(e,t,r,n){var a=r.node,o=r.event,i=d.get(e),s=i[o];if(s&&a.removeEventListener(o,s,s.options),t){t.isEventListener=!0;var l=t.bind(n);return l.options=t.options,a.addEventListener(o,l,l.options),i[o]=l}}function j(l){var f=(l.content||l).cloneNode(!0),u={};return function l(f,c){for(var d=f.childNodes.length-1,g=0;g<=d;g+=1){var p=f.childNodes[g];if(p.nodeType===Node.ELEMENT_NODE)if(p.tagName===v||p.dataset.key){var m=p.dataset.key||p.name,h=_(2,m),y=p.dataset.template,b=y?A[y]||document.querySelector(y):p;if(void 0===m)throw new TypeError("Missing `name` or `data-key` for slot.");if(delete p.dataset.key,!y&&p.tagName===v)for(b=document.createDocumentFragment();p.childNodes.length;){var N=p.childNodes[0];b.appendChild(N)}f.insertBefore(h,p),u.hasOwnProperty(m)||(u[m]=[]),u[m].push({path:c.concat(g),slot:y?p:document.createElement("div"),template:b,type:e}),p.remove()}else for(var x in p.children.length&&l(p,c.concat(g)),p.dataset){var S=p.dataset[x],w=null;switch(x){case"text":w={type:t};break;case"value":w={type:n};break;case"class":w={type:a};break;case"unsafeHtml":w={type:r}}x.startsWith("attribute")&&(w={type:o,name:x.slice(9).toLowerCase()}),x.startsWith("event")&&(w={type:s,event:x.slice(5).toLowerCase()}),w||(w={type:i,name:x},S||(S=x)),w&&(delete p.dataset[x],p.removeAttribute(x),w.path=c.concat(g),u.hasOwnProperty(S)||(u[S]=[]),u[S].push(w))}}}(f,[]),N.set(l,f),x.set(l,u)}function H(e,t){var r=x.get(t),n={};for(var a in r){n[a]=[];for(var o=r[a],i=o.length,s=0;s<i;s+=1){var l=o[s],f=q(e,l.path);n[a].push(Object.assign({node:f},l))}}return n}function q(e,t){for(var r=e,n=t.length-1,a=0;a<=n;a+=1){var o=t[a];r=r.childNodes[o]}return r}function F(e,t){for(var r,n=[],a=[],o=e.length,i=0;i<o;i+=1){var s=I(e[i],t);a.push(s[0]),n.push(s[1])}return r=new Proxy(a,w),y.set(r,t),[n,r]}function I(e,t){N.get(t)||j(t);var r=N.get(t).cloneNode(!0),n={},a=new Proxy(n,S),o=H(r,t),i=_(0,"proxy"),s=_(1,"proxy"),v=[i,s],y=e[l],b=e[f],x=e[u],w=document.createDocumentFragment();for(var k in b&&p.set(a,b),x&&m.set(a,x),c.set(n,o),d.set(n,{}),g.set(n,{}),e)o.hasOwnProperty(k)||(n[k]=e[k]);for(var k in o)W(n,k,e[k],a,!0);return y&&y.call(a,r),w.appendChild(i),w.appendChild(r),w.appendChild(s),h.set(a,v),[a,w]}function _(e,t){if(G.debug){var r=(0===e?"start":1===e?"end":"anchor")+" "+t;return document.createComment(r)}return document.createTextNode("")}function z(e,t){if("string"==typeof t){var r=document.createElement("template");r.innerHTML=t,t=r}return A[e]=t}function G(e,t){return A.hasOwnProperty(t)&&(t=A[t]),I(e,t)}M[t]=function(e,t,r){return r!==e.textContent?e.textContent=r:null},M[r]=function(e,t,r){return r!==e.innerHTML?e.innerHTML=r||"":null},M[n]=function(e,t,r){if(r!==e.value)return e.value=void 0===r?"":r},M[a]=C,M[o]=E,M[i]=P,G.debug=!1,G.isDeferred=!1;export{l as mount,f as unmount,u as move,z as registerTemplate};export default G;
