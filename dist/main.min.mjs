var e="slot",t="text",r="html",n="value",o="class",a="attribute",i="data",l="event",s=Symbol("mount"),f=Symbol("unmount"),u=Symbol("move"),d=Symbol("root"),c=Symbol("target"),v="SLOT",g=new WeakMap,p=new WeakMap,m=new WeakMap,h=new WeakMap,y=new WeakMap,w=new WeakMap,b=new WeakMap,N=new WeakMap,S=new WeakMap,x=new WeakMap,k={set:C,deleteProperty:C},A={set:W,deleteProperty:W},M=[],L={},P={};function W(e,t,r,n,o){if(K.isDeferred&&!o)return B((function(){return W(e,t,r,n,!0)})),!0;K.debug&&console.log("setIndex",arguments);var a=Number.parseInt("string"==typeof t?t:null,10),i=!Number.isNaN(a),l=void 0!==r;if("length"===t)for(var s=e.length-1,f=r;f<=s;f+=1){var u=e[f],c=w.get(u),v=h.get(u);c&&R(c[0],c[1],v,u),delete e[f]}if(!l&&e[t]){var g=e[t],p=w.get(g),m=h.get(g);R(p[0],p[1],m,g),delete e[t]}if(l){if(!i)return Reflect.set(e,t,r,n);if(!e.includes(r)){var S=N.get(n),x=S.parentNode,k=b.get(n),A=z(r,k,n[d]),M=A[0],L=A[1],P=e[t],C=null,E=e.length-1;for(f=a+1;f<=E&&!(C=e[f]);f+=1);if(P&&!e.find((function(e,t){return e===P&&t!==a}))){var O=w.get(P),T=h.get(P);R(O[0],O[1],T,M)}if(C){var D=w.get(C)[0];x.insertBefore(L,D)}else{var j=w.get(n)[1];x.insertBefore(L,j)}return Reflect.set(e,t,M,n)}var H=e.findIndex((function(e,t){return e===r&&t!==a})),q=e[t],F=y.get(r),I=w.get(r),_=I[0],G=I[1];if(q){var J=w.get(q),Q=J[0],U=J[1],V=y.get(q),X=I[1].nextSibling,Y=X.parentNode;if(r!==q){if(F)for(var Z=_.nextSibling;!Z.isSameNode(G);){var $=Z;Z=Z.nextSibling,F.call(r,$)}if(V)for(var ee=Q.nextSibling;!ee.isSameNode(U);){var te=ee;ee=ee.nextSibling,V.call(q,te)}for(var re=_;!re.isSameNode(G);){var ne=re;re=re.nextSibling,Y.insertBefore(ne,Q)}Y.insertBefore(G,Q);for(var oe=Q;!oe.isSameNode(U);){var ae=oe;oe=oe.nextSibling,Y.insertBefore(ae,X)}Y.insertBefore(U,X)}}else if(F)for(var ie=_.nextSibling;!ie.isSameNode(G);){var le=ie;ie=ie.nextSibling,F.call(r,le)}~H&&Reflect.set(e,H,q,n),Reflect.set(e,t,r,n)}return!0}function B(e){return M.length||K.window.requestAnimationFrame((function(){for(var e=M.length;M.length;){M.shift()()}return K.debug?console.log("queue flushed",e):null})),M.push(e)}function C(t,r,o,a,i){if(K.isDeferred&&!i)return B((function(){return C(t,r,o,a,!0)})),!0;K.debug&&console.log("setProperty",arguments);var s=g.get(t),f=void 0!==o,u=t[r]!==o,d=s[r],c=null,v=null,p=null,m=!1;if(d)for(var h=d.length,y=0;y<h;y+=1){var w=d[y];if(c=w.node,v=w.type,u||i)if("function"!=typeof o||v===l||m||(m=!0,p=o.call(a)),P.hasOwnProperty(v))P[v](c,w.name,m?p:o);else if(v===l&&H(t,o,w,a),v===e){var b=j(t,r,m?p:o,a,w,i);if(b)return Reflect.set(t,r,b,a)}v!==n||w.isListening||(c.addEventListener("input",(function(e){return Reflect.set(t,r,e.target.value,a)})),w.isListening=!0)}return f?Reflect.set(t,r,o,a):Reflect.deleteProperty(t,r)}function E(e,t,r){return null!=r&&!1!==r?e.setAttribute(t,!0===r?"":r):e.removeAttribute(t)}function O(e,t,r){return null!=r?e.dataset[t]=r:delete e.dataset[t]}function T(e,t,r){return r?e.className=Array.isArray(r)?r.split(" "):r:e.removeAttribute("class")}function R(e,t,r,n){var o=e,a=o;for(o=o.nextSibling,a.remove();!o.isSameNode(t);)!function(){var e=o;o=o.nextSibling,r?Promise.resolve(r.call(n,e)).then((function(){return e.remove()})):e.remove()}();return t.remove(),n&&D(n,!1,new WeakSet),null}function D(e,t,r){for(var n in r.add(e),e){var o=e[n];"object"!=typeof o||null===o||r.has(o)||D(o,!0,r)}if(t){var a=h.get(e);return a?a.call(e):null}}function j(e,t,r,n,o,a){if(K.debug&&console.log("setSlot",arguments),(e[t]||r||a)&&(void 0===r||"object"==typeof r)){var i=o.node,l=o.slot,s=o.template,f=m.get(e),u=f[t],c=i.parentNode,v=G(0,t),g=G(1,t),p=e[t],y=Array.isArray(p),b=p&&"object"==typeof p,S=Array.isArray(r),x=y!==S,k=null;if(u&&(!r||r&&!p||x)){if(Array.isArray(p))for(var A=p.length,M=0;M<A;M+=1){var L=p[M],P=h.get(L),W=w.get(L);W&&R(W[0],W[1],P,L)}else if(p){var B=h.get(p),C=w.get(p);R(C[0],C[1],B,p)}r&&!p?R(u[0],u[1]):(u[0].remove(),u[1].remove())}if(f[t]=[v,g],c.insertBefore(v,i),r)if(p&&b&&!x){for(var E=y?p:[p],O=S?r:[r],T=O.length-1,D=0;D<=T;D+=1){var j=E[D],H=O[D];if(j){for(var t in H)j[t]=H[t];for(var t in j)H.hasOwnProperty(t)||delete j[t]}else E[D]=H}Array.isArray(p)&&(E.length=O.length),k=p}else if(Array.isArray(r)){for(var q=_(r,s,n[d]),F=q[0],I=q[1],J=F.length,Q=0;Q<J;Q+=1){var U=F[Q];c.insertBefore(U,i)}N.set(I,i),w.set(I,f[t]),k=I}else{var V=z(r,s,n[d]),X=V[0],Y=V[1];c.insertBefore(Y,i),k=X}else for(var Z=l.childNodes,$=Z.length,ee=0;ee<$;ee+=1){var te=Z[ee];c.insertBefore(te.cloneNode(!0),i)}return c.insertBefore(g,i),k}}function H(e,t,r,n){var o=r.node,a=r.event,i=p.get(e),l=i[a];if(l&&o.removeEventListener(a,l,l.options),t){t.isEventListener=!0;var s=t.bind(n);return s.options=t.options,o.addEventListener(a,s,s.options),i[a]=s}}function q(s){var f=(s.content||s).cloneNode(!0),u={};return function s(f,d){for(var c=f.childNodes.length-1,g=0;g<=c;g+=1){var p=f.childNodes[g];if(p.nodeType===K.window.Node.ELEMENT_NODE)if(p.tagName===v||p.dataset.key){var m=p.dataset.key||p.getAttribute("name"),h=G(2,m),y=p.dataset.template,w=y?L[y]||K.window.document.querySelector(y):p;if(void 0===m)throw new TypeError("Missing `name` or `data-key` for slot.");if(delete p.dataset.key,!y&&p.tagName===v)for(w=K.window.document.createDocumentFragment();p.firstChild;){var b=p.firstChild;w.appendChild(b)}if(f.insertBefore(h,p),u.hasOwnProperty(m))throw new Error('The key "'+m+'" was used in a template more than once, which is not allowed.');u[m]=[],u[m].push({path:d.concat(g),slot:y?p:K.window.document.createElement("div"),template:w,type:e}),p.remove()}else for(var N in p.firstChild&&s(p,d.concat(g)),p.dataset){var S=p.dataset[N],x=null;switch(N){case"text":x={type:t};break;case"value":x={type:n};break;case"class":x={type:o};break;case"unsafeHtml":x={type:r}}N.startsWith("attribute")&&(x={type:a,name:N.slice(9).toLowerCase()}),N.startsWith("event")&&(x={type:l,event:N.slice(5).toLowerCase()}),x||(x={type:i,name:N},S||(S=N)),x&&(delete p.dataset[N],p.removeAttribute(N),x.path=d.concat(g),u.hasOwnProperty(S)||(u[S]=[]),u[S].push(x))}}}(f,[]),S.set(s,f),x.set(s,u)}function F(e,t){var r=x.get(t),n={};for(var o in r){n[o]=[];for(var a=r[o],i=a.length,l=0;l<i;l+=1){var s=a[l],f=I(e,s.path);n[o].push(Object.assign({node:f},s))}}return n}function I(e,t){for(var r=e,n=t.length-1,o=0;o<=n;o+=1){var a=t[o];r=r.childNodes[a]}return r}function _(e,t,r){for(var n=[],o=[],a=null,i=e.length,l=0;l<i;l+=1){var s=z(e[l],t,r);o.push(s[0]),n.push(s[1])}return(a=new Proxy(o,A))[d]=r,b.set(a,t),[n,a]}function z(e,t,r){S.get(t)||q(t);var n=S.get(t).cloneNode(!0),o={},a=new Proxy(o,k),i=F(n,t),l=G(0,"proxy"),v=G(1,"proxy"),b=[l,v],N=e[s],x=e[f],A=e[u],M=K.window.document.createDocumentFragment();for(var L in x&&h.set(a,x),A&&y.set(a,A),g.set(o,i),p.set(o,{}),m.set(o,{}),a[d]=r||a,a[c]=e,e)i.hasOwnProperty(L)||(o[L]=e[L]);for(var L in i)C(o,L,e[L],a,!0);return N&&N.call(a,n),M.appendChild(l),M.appendChild(n),M.appendChild(v),w.set(a,b),[a,M]}function G(e,t){if(K.debug){var r=(0===e?"start":1===e?"end":"anchor")+" "+t;return K.window.document.createComment(r)}return K.window.document.createTextNode("")}function J(e,t){if("string"==typeof t){var r=K.window.document.createElement("template");r.innerHTML=t,t=r}return L[e]=t}function K(e,t){return L.hasOwnProperty(t)&&(t=L[t]),z(e,t)}P[t]=function(e,t,r){return r!==e.textContent?e.textContent=r:null},P[r]=function(e,t,r){return r!==e.innerHTML?e.innerHTML=r||"":null},P[n]=function(e,t,r){if(r!==e.value)return e.value=void 0===r?"":r},P[o]=T,P[a]=E,P[i]=O,K.debug=!1,K.isDeferred=!1,K.window="undefined"!=typeof window?window:null;export{s as mount,f as unmount,u as move,d as root,c as target,J as registerTemplate};export default K;
