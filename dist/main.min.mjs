var e="slot",t="text",r="html",n="value",o="class",a="classlist",i="attribute",l="styleProperty",s="data",u="event",f=Symbol("mount"),c=Symbol("unmount"),d=Symbol("move"),v=Symbol("root"),p=Symbol("target"),g="SLOT",m=new WeakMap,h=new WeakMap,y=new WeakMap,w=new WeakMap,b=new WeakMap,N=new WeakMap,S=new WeakMap,x=new WeakMap,k=new WeakMap,A=new WeakMap,L={set:B,deleteProperty:B},M={set:P,deleteProperty:P},C={},W={};function E(e,t){if(e instanceof K.window.Node)return t.childNodes.length&&(t.innerHTML=""),t.appendChild(e),!0}function P(e,t,r,n,o){if(K.isDeferred&&!o)return queueMicrotask((function(){return P(e,t,r,n,!0)})),!0;K.debug&&console.log("setIndex",arguments);var a=Number.parseInt("string"==typeof t?t:null,10),i=!Number.isNaN(a),l=!(null==r);if("length"===t)for(var s=e.length-1,u=r;u<=s;u+=1){var f=e[u],c=N.get(f),d=w.get(f);c&&j(c[0],c[1],d,f),delete e[u]}if(!l&&e[t]){var p=e[t],g=N.get(p),m=w.get(p);j(g[0],g[1],m,p),delete e[t]}if(l){if(!i)return Reflect.set(e,t,r,n);if(!e.includes(r)){var h=x.get(n).parentNode,y=S.get(n),k=z(r,y,n[v]),A=k[0],L=k[1],M=e[t],C=null,W=e.length-1;for(u=a+1;u<=W&&!(C=e[u]);u+=1);if(M&&!e.find((function(e,t){return e===M&&t!==a}))){var E=N.get(M),B=w.get(M);j(E[0],E[1],B,A)}if(C){var O=N.get(C)[0];h.insertBefore(L,O)}else{var R=N.get(n)[1];h.insertBefore(L,R)}return Reflect.set(e,t,A,n)}var T=e.findIndex((function(e,t){return e===r&&t!==a})),D=e[t],H=b.get(r),q=N.get(r),I=q[0],F=q[1];if(D){var U=N.get(D),Z=U[0],_=U[1],G=b.get(D),J=q[1].nextSibling,Q=J.parentNode;if(r!==D){if(H)for(var V=I.nextSibling;!V.isSameNode(F);){var X=V;V=V.nextSibling,H.call(r,X)}if(G)for(var Y=Z.nextSibling;!Y.isSameNode(_);){var $=Y;Y=Y.nextSibling,G.call(D,$)}for(var ee=I;!ee.isSameNode(F);){var te=ee;ee=ee.nextSibling,Q.insertBefore(te,Z)}Q.insertBefore(F,Z);for(var re=Z;!re.isSameNode(_);){var ne=re;re=re.nextSibling,Q.insertBefore(ne,J)}Q.insertBefore(_,J)}}else if(H)for(var oe=I.nextSibling;!oe.isSameNode(F);){var ae=oe;oe=oe.nextSibling,H.call(r,ae)}~T&&Reflect.set(e,T,D,n),Reflect.set(e,t,r,n)}return!0}function B(t,r,o,a,i){if(K.isDeferred&&!i)return queueMicrotask((function(){return B(t,r,o,a,!0)})),!0;K.debug&&console.log("setProperty",arguments);var l=m.get(t),s=!(null==o),f=t[r]!==o,c=l[r],d=null,v=null,p=null,g=!1;if(c)for(var h=c.length,y=0;y<h;y+=1){var w=c[y];if(d=w.node,v=w.type,f||i)if("function"!=typeof o||v===u||g||(g=!0,p=o.call(a)),W.hasOwnProperty(v))W[v](d,w.name,g?p:o);else if(v===u&&I(t,o,w,a),v===e){var b=q(t,r,g?p:o,a,w,i);if(b)return Reflect.set(t,r,b,a)}v!==n||w.isListening||(d.addEventListener("input",(function(e){return Reflect.set(t,r,e.target.value,a)})),w.isListening=!0)}return s?Reflect.set(t,r,o,a):Reflect.deleteProperty(t,r)}function O(e,t,r){return null!=r&&!1!==r?e.setAttribute(t,!0===r?"":r):e.removeAttribute(t)}function R(e,t,r){return null!=r?e.dataset[t]=r:delete e.dataset[t]}function T(e,t,r){return r?e.className=Array.isArray(r)?r.split(" "):r:e.removeAttribute("class")}function D(e,t,r){return r?e.classList.add(t):e.classList.remove(t)}function j(e,t,r,n){var o=e,a=o;for(o=o.nextSibling,a.remove();o&&!o.isSameNode(t);)!function(){var e=o;if(o=o.nextSibling,r){var t=r.call(n,e);return t&&"function"==typeof t.then?t.then((function(){return e.remove()})):e.remove()}e.remove()}();return t.remove(),n&&H(n,!1),null}function H(e,t,r){if(r||(r=new WeakSet),r.add(e),Object.keys(e).forEach((function(t){var n=e[t];return"object"!=typeof n||null===n||r.has(n)?null:H(n,!0,r)})),t){var n=w.get(e);return n?n.call(e):null}}function q(e,t,r,n,o,a){if(K.debug&&console.log("setSlot",arguments),(e[t]||r||a)&&(void 0===r||"object"==typeof r)){var i=o.node,l=o.slot,s=o.template,u=y.get(e),f=u[t],c=i.parentNode,d=null,p=null,g=e[t],m=Array.isArray(g),h=g&&"object"==typeof g,b=Array.isArray(r),S=m!==b,k=!f||!g,A=null;if(f&&(!r||r&&!g||S)){if(Array.isArray(g))for(var L=g.length,M=0;M<L;M+=1){var C=g[M],W=w.get(C),E=N.get(C);E&&j(E[0],E[1],W,C)}else if(g){var P=w.get(g),B=N.get(g);B&&j(B[0],B[1],P,g)}r&&!g?j(f[0],f[1]):(k=!0,f[0].remove(),f[1].remove())}if(k&&(d=G(0,t),p=G(1,t),u[t]=[d,p],c.insertBefore(d,i)),r)if(g&&h&&!S){for(var O=m?g:[g],R=b?r:[r],T=R.length-1,D=0;D<=T;D+=1){var H=O[D],q=R[D];if(H&&q){for(var t in q)H[t]=q[t];for(var t in H)q.hasOwnProperty(t)||delete H[t]}else O[D]=q}Array.isArray(g)&&(O.length=R.length),A=g}else if(Array.isArray(r)){for(var I=_(r,s,n[v]),F=I[0],U=I[1],Z=F.length,J=0;J<Z;J+=1){var Q=F[J];c.insertBefore(Q,i)}x.set(U,i),N.set(U,u[t]),A=U}else{var V=z(r,s,n[v]),X=V[0],Y=V[1];c.insertBefore(Y,i),A=X}else for(var $=l.childNodes,ee=$.length,te=0;te<ee;te+=1){var re=$[te];c.insertBefore(re.cloneNode(!0),i)}return k&&c.insertBefore(p,i),A}}function I(e,t,r,n){var o=r.node,a=r.event,i=h.get(e),l=i[a];l||(l=[],i[a]=l);for(var s=l.length,u=0;u<s;u+=1){var f=l[u];o.removeEventListener(a,f,f.options)}if(t){t.isEventListener=!0;var c=t.bind(n);return c.options=t.options,o.addEventListener(a,c,c.options),l.push(c)}}function F(f){var c=(f.content||f).cloneNode(!0),d={};return function f(c,v){for(var p=c.childNodes.length-1,m=0;m<=p;m+=1){var h=c.childNodes[m];if(h.nodeType===K.window.Node.ELEMENT_NODE)if(h.tagName===g||h.dataset.key){var y=h.dataset.key||h.getAttribute("name"),w=G(2,y),b=h.dataset.template,N=b?C[b]||K.window.document.querySelector(b):h;if(void 0===y)throw new TypeError("Missing `name` or `data-key` for slot.");if(delete h.dataset.key,!b&&h.tagName===g)for(N=K.window.document.createDocumentFragment();h.firstChild;){var S=h.firstChild;N.appendChild(S)}if(c.insertBefore(w,h),d.hasOwnProperty(y))throw new Error('The key "'+y+'" was used in a template more than once, which is not allowed.');d[y]=[],d[y].push({path:v.concat(m),slot:b?h:K.window.document.createElement("div"),template:N,type:e}),h.remove()}else for(var x in h.firstChild&&f(h,v.concat(m)),h.dataset){var k=h.dataset[x],A=null;switch(x){case"text":A={type:t};break;case"value":A={type:n};break;case"class":A={type:o};break;case"unsafeHtml":A={type:r}}x.startsWith("attribute")&&(A={type:i,name:x.slice(9).toLowerCase()}),x.startsWith("style")&&(A={type:l,name:x.slice(5).replaceAll(/[A-Z]/g,(function(e){return"-"+e.toLowerCase()})).slice(1)}),x.startsWith("classlist")&&(A={type:a,name:x[9].toLowerCase()+x.slice(10)}),x.startsWith("event")&&(A={type:u,event:x.slice(5).toLowerCase()}),A||(A={type:s,name:x},k||(k=x)),A&&(delete h.dataset[x],h.removeAttribute(x),A.path=v.concat(m),d.hasOwnProperty(k)||(d[k]=[]),d[k].push(A))}}}(c,[]),k.set(f,c),A.set(f,d)}function U(e,t){var r=A.get(t),n={};for(var o in r){n[o]=[];for(var a=r[o],i=a.length,l=0;l<i;l+=1){var s=a[l],u=Z(e,s.path);n[o].push(Object.assign({node:u},s))}}return n}function Z(e,t){for(var r=e,n=t.length-1,o=0;o<=n;o+=1){var a=t[o];r=r.childNodes[a]}return r}function _(e,t,r){for(var n=[],o=[],a=null,i=e.length,l=0;l<i;l+=1){var s=e[l];if(s){var u=z(s,t,r);o.push(u[0]),n.push(u[1])}}return(a=new Proxy(o,M))[v]=r,S.set(a,t),[n,a]}function z(e,t,r){k.get(t)||F(t);var n=k.get(t).cloneNode(!0),o={},a=new Proxy(o,L),i=U(n,t),l=G(0,"proxy"),s=G(1,"proxy"),u=[l,s],g=e[f],S=e[c],x=e[d],A=K.window.document.createDocumentFragment();for(var M in S&&w.set(a,S),x&&b.set(a,x),m.set(o,i),h.set(o,{}),y.set(o,{}),a[v]=r||a,a[p]=e,e)i.hasOwnProperty(M)||(o[M]=e[M]);for(var M in i)B(o,M,e[M],a,!0);return g&&g.call(a,n),A.appendChild(l),A.appendChild(n),A.appendChild(s),N.set(a,u),[a,A]}function G(e,t){if(K.debug){var r=(0===e?"start":1===e?"end":"anchor")+" "+t;return K.window.document.createComment(r)}return K.window.document.createTextNode("")}function J(e,t){if("string"==typeof t){var r=K.window.document.createElement("template");r.innerHTML=t,t=r}return C[e]=t}function K(e,t){C.hasOwnProperty(t)&&(t=C[t]);var r=z(e,t);return e[c]&&K.shouldUnmountRoot&&Q(r),r}function Q(e){var t=e[0],r=e[1],n=Array.from(r.childNodes);return new K.window.MutationObserver((function(e,r){for(var o=e.length,a=0;a<o;a+=1)for(var i=e[a].removedNodes,l=i.length,s=0;s<l;s+=1)for(var u=i[s],f=n.length-1;f>=0;f-=1){var c=n[f];u.contains(c)&&n.splice(f,1)}if(0===n.length)return H(t,!0),r.disconnect()})).observe(K.window.document.documentElement,{childList:!0,subtree:!0})}W[t]=function(e,t,r){return E(r,e)||(r!==e.textContent?e.textContent=r:null)},W[r]=function(e,t,r){return E(r,e)||(r!==e.innerHTML?e.innerHTML=r||"":null)},W[n]=function(e,t,r){if(r!==e.value)return void 0===r?(e.removeAttribute("value"),e.value=""):(e.setAttribute("value",r),e.value=r)},W[l]=function(e,t,r){return e.style.setProperty(t,r)},W[o]=T,W[a]=D,W[i]=O,W[s]=R,K.debug=!1,K.isDeferred=!1,K.shouldUnmountRoot=!0,K.window="undefined"!=typeof window?window:null;export{f as mount,c as unmount,d as move,v as root,p as target,J as registerTemplate};export default K;
