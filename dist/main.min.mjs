var e="slot",t="text",r="html",n="value",o="class",a="attribute",i="styleProperty",l="data",s="event",u=Symbol("mount"),f=Symbol("unmount"),d=Symbol("move"),c=Symbol("root"),v=Symbol("target"),p="SLOT",g=new WeakMap,m=new WeakMap,y=new WeakMap,h=new WeakMap,w=new WeakMap,b=new WeakMap,N=new WeakMap,S=new WeakMap,x=new WeakMap,A=new WeakMap,k={set:E,deleteProperty:E},M={set:C,deleteProperty:C},L=[],P={},W={};function C(e,t,r,n,o){if(K.isDeferred&&!o)return B((function(){return C(e,t,r,n,!0)})),!0;K.debug&&console.log("setIndex",arguments);var a=Number.parseInt("string"==typeof t?t:null,10),i=!Number.isNaN(a),l=void 0!==r;if("length"===t)for(var s=e.length-1,u=r;u<=s;u+=1){var f=e[u],d=b.get(f),v=h.get(f);d&&D(d[0],d[1],v,f),delete e[u]}if(!l&&e[t]){var p=e[t],g=b.get(p),m=h.get(p);D(g[0],g[1],m,p),delete e[t]}if(l){if(!i)return Reflect.set(e,t,r,n);if(!e.includes(r)){var y=S.get(n),x=y.parentNode,A=N.get(n),k=z(r,A,n[c]),M=k[0],L=k[1],P=e[t],W=null,E=e.length-1;for(u=a+1;u<=E&&!(W=e[u]);u+=1);if(P&&!e.find((function(e,t){return e===P&&t!==a}))){var O=b.get(P),T=h.get(P);D(O[0],O[1],T,M)}if(W){var R=b.get(W)[0];x.insertBefore(L,R)}else{var j=b.get(n)[1];x.insertBefore(L,j)}return Reflect.set(e,t,M,n)}var H=e.findIndex((function(e,t){return e===r&&t!==a})),q=e[t],F=w.get(r),I=b.get(r),Z=I[0],_=I[1];if(q){var G=b.get(q),J=G[0],Q=G[1],U=w.get(q),V=I[1].nextSibling,X=V.parentNode;if(r!==q){if(F)for(var Y=Z.nextSibling;!Y.isSameNode(_);){var $=Y;Y=Y.nextSibling,F.call(r,$)}if(U)for(var ee=J.nextSibling;!ee.isSameNode(Q);){var te=ee;ee=ee.nextSibling,U.call(q,te)}for(var re=Z;!re.isSameNode(_);){var ne=re;re=re.nextSibling,X.insertBefore(ne,J)}X.insertBefore(_,J);for(var oe=J;!oe.isSameNode(Q);){var ae=oe;oe=oe.nextSibling,X.insertBefore(ae,V)}X.insertBefore(Q,V)}}else if(F)for(var ie=Z.nextSibling;!ie.isSameNode(_);){var le=ie;ie=ie.nextSibling,F.call(r,le)}~H&&Reflect.set(e,H,q,n),Reflect.set(e,t,r,n)}return!0}function B(e){return L.length||K.window.requestAnimationFrame((function(){for(var e=L.length;L.length;){L.shift()()}return K.debug?console.log("queue flushed",e):null})),L.push(e)}function E(t,r,o,a,i){if(K.isDeferred&&!i)return B((function(){return E(t,r,o,a,!0)})),!0;K.debug&&console.log("setProperty",arguments);var l=g.get(t),u=void 0!==o,f=t[r]!==o,d=l[r],c=null,v=null,p=null,m=!1;if(d)for(var y=d.length,h=0;h<y;h+=1){var w=d[h];if(c=w.node,v=w.type,f||i)if("function"!=typeof o||v===s||m||(m=!0,p=o.call(a)),W.hasOwnProperty(v))W[v](c,w.name,m?p:o);else if(v===s&&q(t,o,w,a),v===e){var b=H(t,r,m?p:o,a,w,i);if(b)return Reflect.set(t,r,b,a)}v!==n||w.isListening||(c.addEventListener("input",(function(e){return Reflect.set(t,r,e.target.value,a)})),w.isListening=!0)}return u?Reflect.set(t,r,o,a):Reflect.deleteProperty(t,r)}function O(e,t,r){return null!=r&&!1!==r?e.setAttribute(t,!0===r?"":r):e.removeAttribute(t)}function T(e,t,r){return null!=r?e.dataset[t]=r:delete e.dataset[t]}function R(e,t,r){return r?e.className=Array.isArray(r)?r.split(" "):r:e.removeAttribute("class")}function D(e,t,r,n){var o=e,a=o;for(o=o.nextSibling,a.remove();!o.isSameNode(t);)!function(){var e=o;if(o=o.nextSibling,r){var t=r.call(n,e);return t&&"function"==typeof t.then?t.then((function(){return e.remove()})):e.remove()}e.remove()}();return t.remove(),n&&j(n,!1,new WeakSet),null}function j(e,t,r){for(var n in r.add(e),e){var o=e[n];"object"!=typeof o||null===o||r.has(o)||j(o,!0,r)}if(t){var a=h.get(e);return a?a.call(e):null}}function H(e,t,r,n,o,a){if(K.debug&&console.log("setSlot",arguments),(e[t]||r||a)&&(void 0===r||"object"==typeof r)){var i=o.node,l=o.slot,s=o.template,u=y.get(e),f=u[t],d=i.parentNode,v=G(0,t),p=G(1,t),g=e[t],m=Array.isArray(g),w=g&&"object"==typeof g,N=Array.isArray(r),x=m!==N,A=null;if(f&&(!r||r&&!g||x)){if(Array.isArray(g))for(var k=g.length,M=0;M<k;M+=1){var L=g[M],P=h.get(L),W=b.get(L);W&&D(W[0],W[1],P,L)}else if(g){var C=h.get(g),B=b.get(g);B&&D(B[0],B[1],C,g)}r&&!g?D(f[0],f[1]):(f[0].remove(),f[1].remove())}if(u[t]=[v,p],d.insertBefore(v,i),r)if(g&&w&&!x){for(var E=m?g:[g],O=N?r:[r],T=O.length-1,R=0;R<=T;R+=1){var j=E[R],H=O[R];if(j&&H){for(var t in H)j[t]=H[t];for(var t in j)H.hasOwnProperty(t)||delete j[t]}else E[R]=H}Array.isArray(g)&&(E.length=O.length),A=g}else if(Array.isArray(r)){for(var q=_(r,s,n[c]),F=q[0],I=q[1],Z=F.length,J=0;J<Z;J+=1){var Q=F[J];d.insertBefore(Q,i)}S.set(I,i),b.set(I,u[t]),A=I}else{var U=z(r,s,n[c]),V=U[0],X=U[1];d.insertBefore(X,i),A=V}else for(var Y=l.childNodes,$=Y.length,ee=0;ee<$;ee+=1){var te=Y[ee];d.insertBefore(te.cloneNode(!0),i)}return d.insertBefore(p,i),A}}function q(e,t,r,n){var o=r.node,a=r.event,i=m.get(e),l=i[a];if(l&&o.removeEventListener(a,l,l.options),t){t.isEventListener=!0;var s=t.bind(n);return s.options=t.options,o.addEventListener(a,s,s.options),i[a]=s}}function F(u){var f=(u.content||u).cloneNode(!0),d={};return function u(f,c){for(var v=f.childNodes.length-1,g=0;g<=v;g+=1){var m=f.childNodes[g];if(m.nodeType===K.window.Node.ELEMENT_NODE)if(m.tagName===p||m.dataset.key){var y=m.dataset.key||m.getAttribute("name"),h=G(2,y),w=m.dataset.template,b=w?P[w]||K.window.document.querySelector(w):m;if(void 0===y)throw new TypeError("Missing `name` or `data-key` for slot.");if(delete m.dataset.key,!w&&m.tagName===p)for(b=K.window.document.createDocumentFragment();m.firstChild;){var N=m.firstChild;b.appendChild(N)}if(f.insertBefore(h,m),d.hasOwnProperty(y))throw new Error('The key "'+y+'" was used in a template more than once, which is not allowed.');d[y]=[],d[y].push({path:c.concat(g),slot:w?m:K.window.document.createElement("div"),template:b,type:e}),m.remove()}else for(var S in m.firstChild&&u(m,c.concat(g)),m.dataset){var x=m.dataset[S],A=null;switch(S){case"text":A={type:t};break;case"value":A={type:n};break;case"class":A={type:o};break;case"unsafeHtml":A={type:r}}S.startsWith("attribute")&&(A={type:a,name:S.slice(9).toLowerCase()}),S.startsWith("style")&&(A={type:i,name:S.slice(5).replaceAll(/[A-Z]/g,(function(e){return"-"+e.toLowerCase()})).slice(1)}),S.startsWith("event")&&(A={type:s,event:S.slice(5).toLowerCase()}),A||(A={type:l,name:S},x||(x=S)),A&&(delete m.dataset[S],m.removeAttribute(S),A.path=c.concat(g),d.hasOwnProperty(x)||(d[x]=[]),d[x].push(A))}}}(f,[]),x.set(u,f),A.set(u,d)}function I(e,t){var r=A.get(t),n={};for(var o in r){n[o]=[];for(var a=r[o],i=a.length,l=0;l<i;l+=1){var s=a[l],u=Z(e,s.path);n[o].push(Object.assign({node:u},s))}}return n}function Z(e,t){for(var r=e,n=t.length-1,o=0;o<=n;o+=1){var a=t[o];r=r.childNodes[a]}return r}function _(e,t,r){for(var n=[],o=[],a=null,i=e.length,l=0;l<i;l+=1){var s=z(e[l],t,r);o.push(s[0]),n.push(s[1])}return(a=new Proxy(o,M))[c]=r,N.set(a,t),[n,a]}function z(e,t,r){x.get(t)||F(t);var n=x.get(t).cloneNode(!0),o={},a=new Proxy(o,k),i=I(n,t),l=G(0,"proxy"),s=G(1,"proxy"),p=[l,s],N=e[u],S=e[f],A=e[d],M=K.window.document.createDocumentFragment();for(var L in S&&h.set(a,S),A&&w.set(a,A),g.set(o,i),m.set(o,{}),y.set(o,{}),a[c]=r||a,a[v]=e,e)i.hasOwnProperty(L)||(o[L]=e[L]);for(var L in i)E(o,L,e[L],a,!0);return N&&N.call(a,n),M.appendChild(l),M.appendChild(n),M.appendChild(s),b.set(a,p),[a,M]}function G(e,t){if(K.debug){var r=(0===e?"start":1===e?"end":"anchor")+" "+t;return K.window.document.createComment(r)}return K.window.document.createTextNode("")}function J(e,t){if("string"==typeof t){var r=K.window.document.createElement("template");r.innerHTML=t,t=r}return P[e]=t}function K(e,t){return P.hasOwnProperty(t)&&(t=P[t]),z(e,t)}W[t]=function(e,t,r){return r!==e.textContent?e.textContent=r:null},W[r]=function(e,t,r){return r!==e.innerHTML?e.innerHTML=r||"":null},W[n]=function(e,t,r){if(r!==e.value)return void 0===r?(e.removeAttribute("value"),e.value=""):(e.setAttribute("value",r),e.value=r)},W[i]=function(e,t,r){return e.style.setProperty(t,r)},W[o]=R,W[a]=O,W[l]=T,K.debug=!1,K.isDeferred=!1,K.window="undefined"!=typeof window?window:null;export{u as mount,f as unmount,d as move,c as root,v as target,J as registerTemplate};export default K;
