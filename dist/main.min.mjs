var e="slot",t="text",r="html",n="value",a="class",o="classlist",i="attribute",s="styleProperty",l="data",u="event",f=Symbol("mount"),d=Symbol("unmount"),c=Symbol("move"),v=Symbol("root"),p=Symbol("target"),g="SLOT",m=new WeakMap,y=new WeakMap,h=new WeakMap,w=new WeakMap,b=new WeakMap,N=new WeakMap,S=new WeakMap,x=new WeakMap,k=new WeakMap,A=new WeakMap,L={set:E,deleteProperty:E},M={set:P,deleteProperty:P},W={},C={};function P(e,t,r,n,a){if(K.isDeferred&&!a)return queueMicrotask((function(){return P(e,t,r,n,!0)})),!0;K.debug&&console.log("setIndex",arguments);var o=Number.parseInt("string"==typeof t?t:null,10),i=!Number.isNaN(o),s=void 0!==r;if("length"===t)for(var l=e.length-1,u=r;u<=l;u+=1){var f=e[u],d=N.get(f),c=w.get(f);d&&D(d[0],d[1],c,f),delete e[u]}if(!s&&e[t]){var p=e[t],g=N.get(p),m=w.get(p);D(g[0],g[1],m,p),delete e[t]}if(s){if(!i)return Reflect.set(e,t,r,n);if(!e.includes(r)){var y=x.get(n),h=y.parentNode,k=S.get(n),A=z(r,k,n[v]),L=A[0],M=A[1],W=e[t],C=null,E=e.length-1;for(u=o+1;u<=E&&!(C=e[u]);u+=1);if(W&&!e.find((function(e,t){return e===W&&t!==o}))){var B=N.get(W),O=w.get(W);D(B[0],B[1],O,L)}if(C){var T=N.get(C)[0];h.insertBefore(M,T)}else{var R=N.get(n)[1];h.insertBefore(M,R)}return Reflect.set(e,t,L,n)}var j=e.findIndex((function(e,t){return e===r&&t!==o})),H=e[t],q=b.get(r),I=N.get(r),F=I[0],Z=I[1];if(H){var _=N.get(H),G=_[0],J=_[1],Q=b.get(H),U=I[1].nextSibling,V=U.parentNode;if(r!==H){if(q)for(var X=F.nextSibling;!X.isSameNode(Z);){var Y=X;X=X.nextSibling,q.call(r,Y)}if(Q)for(var $=G.nextSibling;!$.isSameNode(J);){var ee=$;$=$.nextSibling,Q.call(H,ee)}for(var te=F;!te.isSameNode(Z);){var re=te;te=te.nextSibling,V.insertBefore(re,G)}V.insertBefore(Z,G);for(var ne=G;!ne.isSameNode(J);){var ae=ne;ne=ne.nextSibling,V.insertBefore(ae,U)}V.insertBefore(J,U)}}else if(q)for(var oe=F.nextSibling;!oe.isSameNode(Z);){var ie=oe;oe=oe.nextSibling,q.call(r,ie)}~j&&Reflect.set(e,j,H,n),Reflect.set(e,t,r,n)}return!0}function E(t,r,a,o,i){if(K.isDeferred&&!i)return queueMicrotask((function(){return E(t,r,a,o,!0)})),!0;K.debug&&console.log("setProperty",arguments);var s=m.get(t),l=void 0!==a,f=t[r]!==a,d=s[r],c=null,v=null,p=null,g=!1;if(d)for(var y=d.length,h=0;h<y;h+=1){var w=d[h];if(c=w.node,v=w.type,f||i)if("function"!=typeof a||v===u||g||(g=!0,p=a.call(o)),C.hasOwnProperty(v))C[v](c,w.name,g?p:a);else if(v===u&&q(t,a,w,o),v===e){var b=H(t,r,g?p:a,o,w,i);if(b)return Reflect.set(t,r,b,o)}v!==n||w.isListening||(c.addEventListener("input",(function(e){return Reflect.set(t,r,e.target.value,o)})),w.isListening=!0)}return l?Reflect.set(t,r,a,o):Reflect.deleteProperty(t,r)}function B(e,t,r){return null!=r&&!1!==r?e.setAttribute(t,!0===r?"":r):e.removeAttribute(t)}function O(e,t,r){return null!=r?e.dataset[t]=r:delete e.dataset[t]}function T(e,t,r){return r?e.className=Array.isArray(r)?r.split(" "):r:e.removeAttribute("class")}function R(e,t,r){return r?e.classList.add(t):e.classList.remove(t)}function D(e,t,r,n){var a=e,o=a;for(a=a.nextSibling,o.remove();!a.isSameNode(t);)!function(){var e=a;if(a=a.nextSibling,r){var t=r.call(n,e);return t&&"function"==typeof t.then?t.then((function(){return e.remove()})):e.remove()}e.remove()}();return t.remove(),n&&j(n,!1),null}function j(e,t,r){for(var n in r||(r=new WeakSet),r.add(e),e){var a=e[n];"object"!=typeof a||null===a||r.has(a)||j(a,!0,r)}if(t){var o=w.get(e);return o?o.call(e):null}}function H(e,t,r,n,a,o){if(K.debug&&console.log("setSlot",arguments),(e[t]||r||o)&&(void 0===r||"object"==typeof r)){var i=a.node,s=a.slot,l=a.template,u=h.get(e),f=u[t],d=i.parentNode,c=G(0,t),p=G(1,t),g=e[t],m=Array.isArray(g),y=g&&"object"==typeof g,b=Array.isArray(r),S=m!==b,k=null;if(f&&(!r||r&&!g||S)){if(Array.isArray(g))for(var A=g.length,L=0;L<A;L+=1){var M=g[L],W=w.get(M),C=N.get(M);C&&D(C[0],C[1],W,M)}else if(g){var P=w.get(g),E=N.get(g);E&&D(E[0],E[1],P,g)}r&&!g?D(f[0],f[1]):(f[0].remove(),f[1].remove())}if(u[t]=[c,p],d.insertBefore(c,i),r)if(g&&y&&!S){for(var B=m?g:[g],O=b?r:[r],T=O.length-1,R=0;R<=T;R+=1){var j=B[R],H=O[R];if(j&&H){for(var t in H)j[t]=H[t];for(var t in j)H.hasOwnProperty(t)||delete j[t]}else B[R]=H}Array.isArray(g)&&(B.length=O.length),k=g}else if(Array.isArray(r)){for(var q=_(r,l,n[v]),I=q[0],F=q[1],Z=I.length,J=0;J<Z;J+=1){var Q=I[J];d.insertBefore(Q,i)}x.set(F,i),N.set(F,u[t]),k=F}else{var U=z(r,l,n[v]),V=U[0],X=U[1];d.insertBefore(X,i),k=V}else for(var Y=s.childNodes,$=Y.length,ee=0;ee<$;ee+=1){var te=Y[ee];d.insertBefore(te.cloneNode(!0),i)}return d.insertBefore(p,i),k}}function q(e,t,r,n){var a=r.node,o=r.event,i=y.get(e),s=i[o];s||(s=[],i[o]=s);for(var l=s.length,u=0;u<l;u+=1){var f=s[u];a.removeEventListener(o,f,f.options)}if(t){t.isEventListener=!0;var d=t.bind(n);return d.options=t.options,a.addEventListener(o,d,d.options),s.push(d)}}function I(f){var d=(f.content||f).cloneNode(!0),c={};return function f(d,v){for(var p=d.childNodes.length-1,m=0;m<=p;m+=1){var y=d.childNodes[m];if(y.nodeType===K.window.Node.ELEMENT_NODE)if(y.tagName===g||y.dataset.key){var h=y.dataset.key||y.getAttribute("name"),w=G(2,h),b=y.dataset.template,N=b?W[b]||K.window.document.querySelector(b):y;if(void 0===h)throw new TypeError("Missing `name` or `data-key` for slot.");if(delete y.dataset.key,!b&&y.tagName===g)for(N=K.window.document.createDocumentFragment();y.firstChild;){var S=y.firstChild;N.appendChild(S)}if(d.insertBefore(w,y),c.hasOwnProperty(h))throw new Error('The key "'+h+'" was used in a template more than once, which is not allowed.');c[h]=[],c[h].push({path:v.concat(m),slot:b?y:K.window.document.createElement("div"),template:N,type:e}),y.remove()}else for(var x in y.firstChild&&f(y,v.concat(m)),y.dataset){var k=y.dataset[x],A=null;switch(x){case"text":A={type:t};break;case"value":A={type:n};break;case"class":A={type:a};break;case"unsafeHtml":A={type:r}}x.startsWith("attribute")&&(A={type:i,name:x.slice(9).toLowerCase()}),x.startsWith("style")&&(A={type:s,name:x.slice(5).replaceAll(/[A-Z]/g,(function(e){return"-"+e.toLowerCase()})).slice(1)}),x.startsWith("classlist")&&(A={type:o,name:x[9].toLowerCase()+x.slice(10)}),x.startsWith("event")&&(A={type:u,event:x.slice(5).toLowerCase()}),A||(A={type:l,name:x},k||(k=x)),A&&(delete y.dataset[x],y.removeAttribute(x),A.path=v.concat(m),c.hasOwnProperty(k)||(c[k]=[]),c[k].push(A))}}}(d,[]),k.set(f,d),A.set(f,c)}function F(e,t){var r=A.get(t),n={};for(var a in r){n[a]=[];for(var o=r[a],i=o.length,s=0;s<i;s+=1){var l=o[s],u=Z(e,l.path);n[a].push(Object.assign({node:u},l))}}return n}function Z(e,t){for(var r=e,n=t.length-1,a=0;a<=n;a+=1){var o=t[a];r=r.childNodes[o]}return r}function _(e,t,r){for(var n=[],a=[],o=null,i=e.length,s=0;s<i;s+=1){var l=z(e[s],t,r);a.push(l[0]),n.push(l[1])}return(o=new Proxy(a,M))[v]=r,S.set(o,t),[n,o]}function z(e,t,r){k.get(t)||I(t);var n=k.get(t).cloneNode(!0),a={},o=new Proxy(a,L),i=F(n,t),s=G(0,"proxy"),l=G(1,"proxy"),u=[s,l],g=e[f],S=e[d],x=e[c],A=K.window.document.createDocumentFragment();for(var M in S&&w.set(o,S),x&&b.set(o,x),m.set(a,i),y.set(a,{}),h.set(a,{}),o[v]=r||o,o[p]=e,e)i.hasOwnProperty(M)||(a[M]=e[M]);for(var M in i)E(a,M,e[M],o,!0);return g&&g.call(o,n),A.appendChild(s),A.appendChild(n),A.appendChild(l),N.set(o,u),[o,A]}function G(e,t){if(K.debug){var r=(0===e?"start":1===e?"end":"anchor")+" "+t;return K.window.document.createComment(r)}return K.window.document.createTextNode("")}function J(e,t){if("string"==typeof t){var r=K.window.document.createElement("template");r.innerHTML=t,t=r}return W[e]=t}function K(e,t){W.hasOwnProperty(t)&&(t=W[t]);var r=z(e,t);return e[d]&&Q(r),r}function Q(e){var t=e[0],r=e[1],n=Array.from(r.children);return new K.window.MutationObserver((function(e,r){for(var a=e.length,o=0;o<a;o+=1)for(var i=e[o].removedNodes,s=i.length,l=0;l<s;l+=1){var u=i[l];if(n.includes(u)){j(t,!0),r.disconnect();break}}})).observe(K.window.document.documentElement,{childList:!0,subtree:!0})}C[t]=function(e,t,r){return r!==e.textContent?e.textContent=r:null},C[r]=function(e,t,r){return r!==e.innerHTML?e.innerHTML=r||"":null},C[n]=function(e,t,r){if(r!==e.value)return void 0===r?(e.removeAttribute("value"),e.value=""):(e.setAttribute("value",r),e.value=r)},C[s]=function(e,t,r){return e.style.setProperty(t,r)},C[a]=T,C[o]=R,C[i]=B,C[l]=O,K.debug=!1,K.isDeferred=!1,K.window="undefined"!=typeof window?window:null;export{f as mount,d as unmount,c as move,v as root,p as target,J as registerTemplate};export default K;
